# GitHub Actions で ZMK ファームウェアをビルドするためのワークフロー
name: Build Caravelle BLE ZMK Firmware

on:
  push:
    branches:
      - main
    paths:
      # config/ フォルダ内のファイルが変更されたときにビルドをトリガー
      - 'config/**'
  workflow_dispatch:

jobs:
  build:
    uses: zmkfirmware/zmk/.github/workflows/build-shield.yml@main
    
    with:
      # ZMKのバージョンを指定 (安定版のタグを指定推奨, e.g., @v3.6.0)
      # ここでは一旦 @main を維持
      
      # 使用するボードを指定 (nRF52832)
      board: nrf52dk_nrf52832
      
      # 使用するカスタム設定ファイル
      conf_file: config/caravelle.conf
      
      # 左右両方のシールドをYAML配列形式で渡します
      shields: |
        - shield: caravelle_left
          build_arg_file_prefix: caravelle_ble_left
        - shield: caravelle_right
          build_arg_file_prefix: caravelle_ble_right