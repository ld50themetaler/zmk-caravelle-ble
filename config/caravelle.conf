CONFIG_BT_DEVICE_NAME="Caravelle"

CONFIG_ZMK_BLE=y
CONFIG_GPIO=y
CONFIG_ZMK_SLEEP=y
CONFIG_ZMK_IDLE_TIMEOUT=30000

# 0番ピン解放
CONFIG_GPIO_AS_PINRESET=n

# TODO 設定値の見直し
# クロック設定 (RCオシレータを安定化する設定)
CONFIG_CLOCK_CONTROL_NRF_K32SRC_RC=y
CONFIG_CLOCK_CONTROL_NRF_K32SRC_XTAL=n
CONFIG_CLOCK_CONTROL_NRF_K32SRC_500PPM=y
# RC校正を有効化してタイミングドリフトを防止
CONFIG_CLOCK_CONTROL_NRF_K32SRC_RC_CALIBRATION=y

# 送信パワーを上げて接続安定性を向上
CONFIG_BT_CTLR_TX_PWR_PLUS_8=y

# ログ設定
CONFIG_LOG=n

# DEFERRED モードでRTTログのオーバーヘッドを削減しつつ、起動直後を確実に拾う
CONFIG_LOG_MODE_DEFERRED=y
CONFIG_LOG_DEFAULT_LEVEL=3
CONFIG_LOG_MODE_OVERFLOW=y

CONFIG_USE_SEGGER_RTT=y
CONFIG_LOG_BACKEND_RTT=y
CONFIG_SEGGER_RTT_BUFFER_SIZE_UP=3072
CONFIG_SEGGER_RTT_BUFFER_SIZE_DOWN=128

# Set ZMK and BT to INFO so key settings logs are visible without excessive debug overhead
CONFIG_ZMK_LOG_LEVEL_INF=y
#CONFIG_BT_LOG_LEVEL_INF=y
#CONFIG_BT_LOG_LEVEL_DBG=y
#CONFIG_BT_SMP_LOG_LEVEL_DBG=y

# Keep kscan noise low to avoid flooding RTT
CONFIG_KSCAN_LOG_LEVEL_WRN=y

# NVS設定を有効化 (ペアリングなどの情報保存用)
CONFIG_SETTINGS=y
CONFIG_NVS=y
CONFIG_SETTINGS_NVS=y
CONFIG_SETTINGS_NVS_SECTOR_COUNT=4
CONFIG_SETTINGS_RUNTIME=y
CONFIG_BT_SETTINGS=y
CONFIG_USE_DT_CODE_PARTITION=y

CONFIG_FLASH=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_FLASH_MAP=y
CONFIG_SOC_FLASH_NRF=y

# バッテリー関係
CONFIG_ZMK_BATTERY_REPORTING=y
# 非LiPo電池管理を有効化
CONFIG_ZMK_NON_LIPO_BATTERY_MANAGEMENT=y
# 下限電圧 (0%)
CONFIG_ZMK_NON_LIPO_MIN_MV=2200
# 上限電圧 (100%)
CONFIG_ZMK_NON_LIPO_MAX_MV=3000
# シャットダウン電圧
CONFIG_ZMK_NON_LIPO_LOW_MV=2000
# アドバタイズのスリープタイムアウト (ミリ秒)
CONFIG_ZMK_NON_LIPO_ADV_SLEEP_TIMEOUT=60000
